function [ dX_dt ] = spatial_Quad_function( t,X )

    %% Order of states of the system
    % States (X) of the system are assumed in following order
    % X = [x y z phi th psi dx_dt dy_dt dz_dt dphi_dt dth_dt dpsi_dt]'
    %%
    
    %% Robot and Environment parameters
    m = 1.003;
    L = 0.25;
    Ixx = 0.0157; Ixy = 0;     Ixz = 0;
    Iyx = 0;      Iyy = 0.134; Iyz = 0;
    Izx = 0;      Izy = 0;     Izz = 0.022;
    
    g = 9.81;
    Ax = 0;
    Ay = 0;
    Az = 0;
    %%
    
    %% Assigning states to variable for ease of writing equations
    x = X(1);
    y = X(2);
    z = X(3);
    phi = X(4);
    th = X(5);
    psi = X(6);
    dx_dt = X(7);
    dy_dt = X(8);
    dz_dt = X(9);
    dphi_dt = X(10);
    dth_dt = X(11);
    dpsi_dt = X(12);
    Vx = dx_dt;
    Vy = dy_dt;
    Vz = dz_dt;
    Vphi = dphi_dt;
    Vth = dth_dt;
    Vpsi = dpsi_dt;
    %%
    
    %% Desired trajectory of the quadcopter
    x_des = 0;
    y_des = 2;
    z_des = 2;
    psi_des = 0;
    Vx_des = 0;
    Vy_des = 0;
    Vz_des = 0;
    Vphi_des = 0;
    Vth_des = 0;
    Vpsi_des = 0;
    Ax_des = 0;
    Ay_des = 0;
    Az_des = 0;
    Apsi_des = 0;
    %%
    
    %% Proporitonality constants for controller (uncomment the situation which ever is required)
    Kpx = 0.15;
    Kdx = 0.55;
    Kpy = 0.15;
    Kdy = 0.55;
    Kpz = 0.35;
    Kdz = 0.85;
    Kpphi = 6.5;
    Kdphi = 2.5;
    Kpth = 6.5;
    Kdth = 2.5;
    Kppsi = 1;
    Kdpsi = 1.67;
    %%
    
    %% Controll inputs to the system
    xdd = Ax_des + Kpx*(x_des-x) + Kdx*(Vx_des-Vx);
    ydd = Ay_des + Kpy*(y_des-y) + Kdy*(Vy_des-Vy);
    
    phi_des = (1/g)*(xdd*sin(psi) - ydd*cos(psi));
    th_des = (1/g)*(xdd*cos(psi) + ydd*sin(psi));
    U1 = m*(g + Az_des + Kpz*(z_des-z) + Kdz*(Vz_des-Vz));
    
    U2 = Ixx*(Kpphi*(phi_des-phi) + Kdphi*(Vphi_des-Vphi));
    U3 = Iyy*(Kpth *(th_des -th)  + Kdth *(Vth_des -Vth ));
    U4 = Izz*(Kppsi*(psi_des-psi) + Kdpsi*(Vpsi_des-Vpsi)) + Apsi_des;
%     % limiting inputs within the saturation limit
%     U1 = min(max(0,U1),2*m*g); % equivalent to 0 < U1 < 2mg
%     U2 = min(max(-m*g*L,U2),m*g*L); % equivalent to -mgL < U2 < mgL
%     U3 = min(max(-m*g*L,U2),m*g*L); % equivalent to -mgL < U2 < mgL
%     U4 = min(max(-m*g*L,U2),m*g*L); % equivalent to -mgL < U2 < mgL
    %%
    
    %% Set of linear differential equations of the system
    dX_dt(1) = X(7);
    dX_dt(2) = X(8);
    dX_dt(3) = X(9);
    dX_dt(4) = X(10);
    dX_dt(5) = X(11);
    dX_dt(6) = X(12);
    dX_dt(7) = -(Ax*dx_dt - U1*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(th)))/m;
    dX_dt(8) = -(Ay*dy_dt + U1*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(th)))/m;
    dX_dt(9) = -(Az*dz_dt + g*m - U1*cos(phi)*cos(th))/m;
    dX_dt(10) = -(Ixy*Iyx*U4*cos(phi)*sin(th) - Ixx*Iyy*U4*cos(phi)*sin(th) + Ixx*Izy*U3*cos(phi)*sin(th) - Ixy*Izx*U3*cos(phi)*sin(th) - Iyx*Izy*U2*cos(phi)*sin(th) + Iyy*Izx*U2*cos(phi)*sin(th) + Ixx*Iyz*U4*sin(phi)*sin(th) - Ixz*Iyx*U4*sin(phi)*sin(th) - Ixx*Izz*U3*sin(phi)*sin(th) + Ixz*Izx*U3*sin(phi)*sin(th) + Iyx*Izz*U2*sin(phi)*sin(th) - Iyz*Izx*U2*sin(phi)*sin(th) - Ixy^2*Iyz*dth_dt^2*cos(phi)^4*cos(th) - Iyz*Izy^2*dth_dt^2*cos(phi)^4*cos(th) - Ixy*Iyx^2*dpsi_dt^2*cos(phi)*sin(th)^3 - Ixy*Izx^2*dpsi_dt^2*cos(phi)*sin(th)^3 + Ixy^2*Iyx*dth_dt^2*cos(phi)^3*sin(th) + Ixz^2*Izy*dth_dt^2*cos(th)*sin(phi)^4 + Iyx*Izy^2*dth_dt^2*cos(phi)^3*sin(th) + Iyz^2*Izy*dth_dt^2*cos(th)*sin(phi)^4 + Ixz*Iyx^2*dpsi_dt^2*sin(phi)*sin(th)^3 + Ixz*Izx^2*dpsi_dt^2*sin(phi)*sin(th)^3 - Ixz^2*Izx*dth_dt^2*sin(phi)^3*sin(th) - Iyz^2*Izx*dth_dt^2*sin(phi)^3*sin(th) - Ixy*Iyz*U4*cos(phi)^2*cos(th) + Ixz*Iyy*U4*cos(phi)^2*cos(th) + Ixy*Izz*U3*cos(phi)^2*cos(th) - Ixz*Izy*U3*cos(phi)^2*cos(th) - Iyy*Izz*U2*cos(phi)^2*cos(th) + Iyz*Izy*U2*cos(phi)^2*cos(th) - Ixy*Iyz*U4*cos(th)*sin(phi)^2 + Ixz*Iyy*U4*cos(th)*sin(phi)^2 + Ixy*Izz*U3*cos(th)*sin(phi)^2 - Ixz*Izy*U3*cos(th)*sin(phi)^2 - Iyy*Izz*U2*cos(th)*sin(phi)^2 + Iyz*Izy*U2*cos(th)*sin(phi)^2 + Ixz^2*Izy*dpsi_dt^2*cos(phi)^4*cos(th)^3 + Iyz^2*Izy*dpsi_dt^2*cos(phi)^4*cos(th)^3 - Ixy^2*Iyz*dpsi_dt^2*cos(th)^3*sin(phi)^4 - Iyz*Izy^2*dpsi_dt^2*cos(th)^3*sin(phi)^4 - Ixy*Iyx^2*dphi_dt^2*cos(phi)*sin(th) - Ixy*Izx^2*dphi_dt^2*cos(phi)*sin(th) + Ixz*Iyx^2*dphi_dt^2*sin(phi)*sin(th) + Ixz*Izx^2*dphi_dt^2*sin(phi)*sin(th) - Ixz^2*Iyy*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 - Ixz^2*Iyy*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) + Ixy^2*Izz*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 + Ixy^2*Izz*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) - Iyy*Izz^2*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 - Iyy*Izz^2*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) + Iyy^2*Izz*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 + Iyy^2*Izz*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) + Ixy*Iyx*Iyz*dphi_dt^2*cos(phi)^2*cos(th) - Ixz*Iyx*Iyy*dphi_dt^2*cos(phi)^2*cos(th) + Ixy*Izx*Izz*dphi_dt^2*cos(phi)^2*cos(th) - Ixz*Izx*Izy*dphi_dt^2*cos(phi)^2*cos(th) + Ixy*Ixz*Iyy*dth_dt^2*cos(phi)^4*cos(th) + Iyy*Izy*Izz*dth_dt^2*cos(phi)^4*cos(th) + Ixz^2*Iyx*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) - Ixy^2*Izx*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) - Iyy^2*Izx*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) + Iyx*Izz^2*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) + Ixy*Iyx*Iyz*dphi_dt^2*cos(th)*sin(phi)^2 - Ixz*Iyx*Iyy*dphi_dt^2*cos(th)*sin(phi)^2 + Ixx*Iyx*Iyy*dpsi_dt^2*cos(phi)*sin(th)^3 + Ixy*Izx*Izz*dphi_dt^2*cos(th)*sin(phi)^2 - Ixz*Izx*Izy*dphi_dt^2*cos(th)*sin(phi)^2 + Ixx*Izx*Izy*dpsi_dt^2*cos(phi)*sin(th)^3 - Ixx*Ixy*Iyy*dth_dt^2*cos(phi)^3*sin(th) - Ixy*Ixz*Izz*dth_dt^2*cos(th)*sin(phi)^4 - Iyy*Iyz*Izz*dth_dt^2*cos(th)*sin(phi)^4 - Iyy*Izx*Izy*dth_dt^2*cos(phi)^3*sin(th) - Ixz*Iyy^2*dphi_dt*dth_dt*cos(phi)^3*cos(th) - Ixz*Izy^2*dphi_dt*dth_dt*cos(phi)^3*cos(th) - Ixx*Iyx*Iyz*dpsi_dt^2*sin(phi)*sin(th)^3 - Ixx*Izx*Izz*dpsi_dt^2*sin(phi)*sin(th)^3 + Ixx*Ixz*Izz*dth_dt^2*sin(phi)^3*sin(th) + Iyx*Iyz*Izz*dth_dt^2*sin(phi)^3*sin(th) + 2*Ixy*Iyx^2*dphi_dt*dpsi_dt*cos(phi)*sin(th)^2 + 2*Ixy*Izx^2*dphi_dt*dpsi_dt*cos(phi)*sin(th)^2 + Ixx*Iyy^2*dphi_dt*dth_dt*cos(phi)^2*sin(th) - Ixx^2*Iyy*dphi_dt*dth_dt*cos(phi)^2*sin(th) - Ixy*Iyz^2*dphi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixx*Izy^2*dphi_dt*dth_dt*cos(phi)^2*sin(th) - Ixy*Izz^2*dphi_dt*dth_dt*cos(th)*sin(phi)^3 - Iyy*Izx^2*dphi_dt*dth_dt*cos(phi)^2*sin(th) - 2*Ixz*Iyx^2*dphi_dt*dpsi_dt*sin(phi)*sin(th)^2 - 2*Ixz*Izx^2*dphi_dt*dpsi_dt*sin(phi)*sin(th)^2 + Ixx*Iyz^2*dphi_dt*dth_dt*sin(phi)^2*sin(th) + Ixx*Izz^2*dphi_dt*dth_dt*sin(phi)^2*sin(th) - Ixx^2*Izz*dphi_dt*dth_dt*sin(phi)^2*sin(th) - Iyx^2*Izz*dphi_dt*dth_dt*sin(phi)^2*sin(th) + Ixz^2*Iyy*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 + Ixz^2*Iyy*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) - Ixy^2*Izz*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 - Ixy^2*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) + Iyy*Izz^2*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 + Iyy*Izz^2*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) - Iyy^2*Izz*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 - Iyy^2*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) - Ixy^2*Iyz*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 + Ixz^2*Izy*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 - Iyz*Izy^2*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 + Iyz^2*Izy*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 - Ixy*Iyz^2*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) + Ixx^2*Izy*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 - Ixy*Izz^2*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) + Iyx^2*Izy*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 - Ixy*Ixz*Izz*dpsi_dt^2*cos(phi)^4*cos(th)^3 - Iyy*Iyz*Izz*dpsi_dt^2*cos(phi)^4*cos(th)^3 - Ixx^2*Iyz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 + Ixz*Iyy^2*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) + Ixz*Izy^2*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) - Iyz*Izx^2*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 + Ixy*Ixz*Iyy*dpsi_dt^2*cos(th)^3*sin(phi)^4 + Iyy*Izy*Izz*dpsi_dt^2*cos(th)^3*sin(phi)^4 + Ixy*Iyz^2*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 + Ixy*Izz^2*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 + Ixz^2*Iyy*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 - Ixy^2*Izz*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 + Iyy*Izz^2*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 - Iyy^2*Izz*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 - Ixz*Iyy^2*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 - Ixz*Izy^2*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 - Ixx*Iyy^2*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 + Ixx^2*Iyy*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 - Ixz^2*Iyy*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 - Ixx*Izy^2*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 + Ixy^2*Izz*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 + Iyy*Izx^2*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 - Iyy*Izz^2*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 + Iyy^2*Izz*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 - Ixx*Iyz^2*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 - Ixx*Izz^2*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixx^2*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Iyx^2*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixx*Iyx*Iyy*dphi_dt^2*cos(phi)*sin(th) + Ixx*Izx*Izy*dphi_dt^2*cos(phi)*sin(th) - Ixy^2*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 + Ixz^2*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 - Iyz*Izy^2*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 + Iyz^2*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 - Ixx*Iyx*Iyz*dphi_dt^2*sin(phi)*sin(th) - Ixx*Izx*Izz*dphi_dt^2*sin(phi)*sin(th) - Ixy*Iyz^2*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixz*Iyy^2*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - Ixy*Izz^2*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixz*Izy^2*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - Ixx^2*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) - Iyx^2*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) + Ixz*Iyy^2*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) + Ixy^2*Izx*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) + Ixz*Izy^2*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) + Iyy^2*Izx*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) - Ixx*Ixy*Iyz*dphi_dt*dth_dt*cos(phi)^3*cos(th) + Ixx*Ixz*Iyy*dphi_dt*dth_dt*cos(phi)^3*cos(th) + Ixy*Iyy*Iyz*dphi_dt*dth_dt*cos(phi)^3*cos(th) + Ixy*Izy*Izz*dphi_dt*dth_dt*cos(phi)^3*cos(th) + Iyy*Izx*Izz*dphi_dt*dth_dt*cos(phi)^3*cos(th) - Iyz*Izx*Izy*dphi_dt*dth_dt*cos(phi)^3*cos(th) - Ixx^2*Iyz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Ixx^2*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Iyx^2*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Iyz*Izx^2*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 + Ixx^2*Iyz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) + Iyz*Izx^2*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) + Ixz^2*Iyx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) + Ixy*Iyz^2*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) + Ixy*Izz^2*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) + Iyx*Izz^2*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) - 2*Ixx*Iyx*Iyy*dphi_dt*dpsi_dt*cos(phi)*sin(th)^2 - 2*Ixx*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)*sin(th)^2 + Ixx*Ixy*Iyx*dphi_dt*dth_dt*cos(phi)^2*sin(th) - Ixy*Iyx*Iyy*dphi_dt*dth_dt*cos(phi)^2*sin(th) + Ixx*Ixy*Izz*dphi_dt*dth_dt*cos(th)*sin(phi)^3 - Ixx*Ixz*Izy*dphi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixz*Iyy*Iyz*dphi_dt*dth_dt*cos(th)*sin(phi)^3 - Ixx*Iyy*Izz*dphi_dt*dth_dt*cos(phi)^2*sin(th) + Ixx*Iyz*Izy*dphi_dt*dth_dt*cos(phi)^2*sin(th) + Ixy*Iyx*Izz*dphi_dt*dth_dt*cos(phi)^2*sin(th) - Ixy*Iyz*Izx*dphi_dt*dth_dt*cos(phi)^2*sin(th) - Ixz*Iyx*Izy*dphi_dt*dth_dt*cos(phi)^2*sin(th) + Ixz*Iyy*Izx*dphi_dt*dth_dt*cos(phi)^2*sin(th) - Ixy*Izx*Izy*dphi_dt*dth_dt*cos(phi)^2*sin(th) + Iyx*Iyy*Izz*dphi_dt*dth_dt*cos(th)*sin(phi)^3 - Iyx*Iyz*Izy*dphi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixz*Izy*Izz*dphi_dt*dth_dt*cos(th)*sin(phi)^3 + Iyx*Izx*Izy*dphi_dt*dth_dt*cos(phi)^2*sin(th) + 2*Ixx*Iyx*Iyz*dphi_dt*dpsi_dt*sin(phi)*sin(th)^2 + 2*Ixx*Izx*Izz*dphi_dt*dpsi_dt*sin(phi)*sin(th)^2 + Ixx*Ixz*Izx*dphi_dt*dth_dt*sin(phi)^2*sin(th) - Ixz*Iyx*Iyz*dphi_dt*dth_dt*sin(phi)^2*sin(th) - Ixx*Iyy*Izz*dphi_dt*dth_dt*sin(phi)^2*sin(th) + Ixx*Iyz*Izy*dphi_dt*dth_dt*sin(phi)^2*sin(th) + Ixy*Iyx*Izz*dphi_dt*dth_dt*sin(phi)^2*sin(th) - Ixy*Iyz*Izx*dphi_dt*dth_dt*sin(phi)^2*sin(th) - Ixz*Iyx*Izy*dphi_dt*dth_dt*sin(phi)^2*sin(th) + Ixz*Iyy*Izx*dphi_dt*dth_dt*sin(phi)^2*sin(th) + Iyx*Iyz*Izx*dphi_dt*dth_dt*sin(phi)^2*sin(th) - Ixz*Izx*Izz*dphi_dt*dth_dt*sin(phi)^2*sin(th) + Ixy^2*Iyx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Ixz^2*Iyx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Ixy*Iyz^2*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) + Ixz*Iyy^2*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Ixy^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) - Ixz^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) - Ixy*Izz^2*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) + Ixz*Izy^2*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Iyx*Izy^2*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) + Iyy^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) - Iyx*Izz^2*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Iyz^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) - Ixy*Ixz*Iyz*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 - Ixy*Ixz*Iyz*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) + Ixy*Ixz*Izy*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 + Ixy*Ixz*Izy*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) + Iyy*Iyz*Izy*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 + Iyy*Iyz*Izy*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) + Ixy*Ixz*Iyy*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 - Iyz*Izy*Izz*dpsi_dt^2*cos(phi)*cos(th)^3*sin(phi)^3 - Iyz*Izy*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^3*sin(phi) - Ixy*Ixz*Izz*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 - Iyy*Iyz*Izz*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 + Iyy*Izy*Izz*dth_dt^2*cos(phi)^2*cos(th)*sin(phi)^2 - Ixx*Ixy*Izx*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 - Ixx*Iyy*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 + 2*Ixy*Iyx*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 - Ixz*Iyx*Iyy*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 + Ixx*Ixy*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) - 2*Ixx*Ixz*Izy*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) + Ixy*Ixz*Izx*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) + Ixz*Iyy*Iyz*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) - Iyx*Iyy*Izx*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 - Ixx*Izy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 + 2*Ixy*Izx*Izz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 - Ixz*Izx*Izy*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th)^2 + Iyx*Iyy*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) - 2*Iyx*Iyz*Izy*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) + Iyy*Iyz*Izx*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) + Ixz*Izy*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^2*sin(th) + Ixx*Ixz*Iyx*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 + 2*Ixx*Ixy*Iyz*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) - Ixx*Ixz*Iyy*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) - Ixy*Ixz*Iyx*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) + Ixx*Iyy*Iyz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 + Ixy*Iyx*Iyz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 - 2*Ixz*Iyx*Iyy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 - Ixy*Iyy*Iyz*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) + Ixx*Izy*Izz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 + Ixy*Izx*Izz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 - 2*Ixz*Izx*Izy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 - Ixy*Izy*Izz*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) + Iyx*Izx*Izz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th)^2 - Iyx*Izy*Izz*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) - Iyy*Izx*Izz*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) + 2*Iyz*Izx*Izy*dpsi_dt^2*cos(th)^2*sin(phi)^3*sin(th) + Ixy*Iyz^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 - Ixz*Iyy^2*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) + Ixy*Izz^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 - Ixz*Izy^2*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) - 2*Ixy^2*Iyz*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 - 2*Ixy^2*Iyz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) - 2*Ixz^2*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 - 2*Ixz^2*Izy*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) - 2*Iyz*Izy^2*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 - 2*Iyz*Izy^2*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) - 2*Iyz^2*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 - 2*Iyz^2*Izy*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) - Ixx*Ixy*Izz*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 + Ixx*Ixz*Izy*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 - Ixz*Iyy*Iyz*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 - Iyx*Iyy*Izz*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 + Iyx*Iyz*Izy*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 - Ixz*Izy*Izz*dphi_dt*dpsi_dt*cos(phi)^3*cos(th)^2 - Ixy*Ixz*Iyz*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 + Ixy*Ixz*Izy*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 - Ixx*Iyy*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)^2 + Ixx*Iyz*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)^2 + Ixy*Iyx*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)^2 - Ixy*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)^2 - Ixz*Iyx*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)^2 + Ixz*Iyy*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)^2 + Iyy*Iyz*Izy*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 - Iyz*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^4*cos(th)^2 - Ixx*Ixy*Iyz*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 + Ixx*Ixz*Iyy*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 + Ixy*Iyy*Iyz*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 + Ixy*Izy*Izz*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 - Ixx*Ixy*Iyx*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 + Iyy*Izx*Izz*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 - Iyz*Izx*Izy*dphi_dt*dpsi_dt*cos(th)^2*sin(phi)^3 + Ixy*Ixz*Iyz*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 + Ixy*Iyx*Iyy*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 - Ixy*Ixz*Izy*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 - Ixx*Iyy*Izz*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 - Ixx*Iyy*Izz*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^2 + Ixx*Iyz*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 + Ixx*Iyz*Izy*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^2 + Ixy*Iyx*Izz*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 + Ixy*Iyx*Izz*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^2 - Ixy*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 - Ixy*Iyz*Izx*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^2 - Ixz*Iyx*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 - Ixz*Iyx*Izy*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^2 + Ixz*Iyy*Izx*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 + Ixz*Iyy*Izx*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^2 + Ixy*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 - Iyy*Iyz*Izy*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 - Iyx*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th)^2 + Iyz*Izy*Izz*dpsi_dt*dth_dt*cos(th)^2*sin(phi)^4 - Ixx*Ixz*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixz*Iyx*Iyz*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 - Ixx*Iyy*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixx*Iyz*Izy*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixy*Iyx*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 - Ixy*Iyz*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 - Ixz*Iyx*Izy*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixz*Iyy*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 - Iyx*Iyz*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixz*Izx*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th)^2 + Ixy*Ixz*Iyy*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 - Ixy*Ixz*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 - Iyy*Iyz*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 + Iyy*Izy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^3*sin(phi)^2 + Ixx^2*Iyz*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixx^2*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Iyx^2*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Iyz*Izx^2*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Iyy^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Ixx^2*Iyy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Ixx*Iyz^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 - Ixx*Izy^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Ixx*Izz^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 - Ixx^2*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Iyy*Izx^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 - Iyx^2*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Ixy*Ixz*Iyz*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 + Ixy*Ixz*Iyz*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) - Ixy*Ixz*Izy*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 - Ixy*Ixz*Izy*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) - Iyy*Iyz*Izy*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 - Iyy*Iyz*Izy*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) + Iyz*Izy*Izz*dth_dt^2*cos(phi)*cos(th)*sin(phi)^3 + Iyz*Izy*Izz*dth_dt^2*cos(phi)^3*cos(th)*sin(phi) + Ixx*Ixy*Iyz*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) + Ixx*Ixz*Iyy*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) - 2*Ixy*Ixz*Iyx*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) - Ixx*Ixz*Iyz*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) + Ixx*Ixy*Izy*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) - Ixx*Ixy*Izz*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) - Ixx*Ixz*Izy*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) + 2*Ixy*Ixz*Izx*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) + Iyx*Iyy*Izy*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) - Iyx*Iyy*Izz*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) - Iyx*Iyz*Izy*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) + 2*Iyy*Iyz*Izx*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) - 2*Iyx*Izy*Izz*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) + Iyy*Izx*Izz*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) + Iyz*Izx*Izy*dth_dt^2*cos(phi)^2*sin(phi)*sin(th) - Iyz*Izx*Izz*dth_dt^2*cos(phi)*sin(phi)^2*sin(th) + Ixx*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 + Ixx*Ixy*Izx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 + 2*Ixx*Iyy*Iyz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Ixy*Iyx*Iyz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Ixz*Iyx*Iyy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 + Iyx*Iyy*Izx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 + 2*Ixx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Ixy*Izx*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Ixz*Izx*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 + Iyx*Izx*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th)^2 - Ixx*Ixz*Iyx*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) - Ixx*Iyy*Iyz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) - 2*Ixy*Iyx*Iyz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) + 3*Ixz*Iyx*Iyy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) - Ixx*Izy*Izz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) - 2*Ixy*Izx*Izz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) + 3*Ixz*Izx*Izy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) - Iyx*Izx*Izz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2*sin(th) - Ixx*Ixz*Iyz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) - 2*Ixx*Ixy*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) + Ixx*Ixz*Izy*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) + Ixy*Ixz*Izx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) - Ixz*Iyy*Iyz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) - 2*Iyx*Iyy*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) + Iyx*Iyz*Izy*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) + Iyy*Iyz*Izx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) - Ixz*Izy*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) - Iyz*Izx*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3*sin(th) - Ixx*Ixy*Iyy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) + Ixx*Ixy*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) - 2*Ixx*Ixz*Iyy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Ixy*Ixz*Iyx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Ixx*Ixz*Iyz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Ixx*Ixy*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + 2*Ixx*Ixy*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Ixx*Ixz*Izy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Ixy*Ixz*Izx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) + Ixx*Ixz*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) - Ixy*Iyy*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Ixz*Iyy*Iyz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Iyx*Iyy*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + 2*Iyx*Iyy*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Iyx*Iyz*Izy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Iyy*Iyz*Izx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Ixy*Izy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Iyx*Iyz*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Ixz*Izy*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Iyy*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) + Iyx*Izy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) - 2*Iyy*Izx*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Iyz*Izx*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi)*sin(th) + Iyz*Izx*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2*sin(th) - Ixx*Ixy*Iyz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) + Ixx*Ixz*Iyy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) - Ixx*Ixy*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 + Ixx*Ixz*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 + Ixy*Iyy*Iyz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) - Ixz*Iyy*Iyz*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 - Iyx*Iyy*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 + Iyx*Iyz*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 + Ixy*Izy*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) - Ixz*Izy*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)^2*sin(phi)^2 + Iyy*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) - Iyz*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)^2*sin(phi) + 2*Ixy*Ixz*Iyy*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 + 2*Ixy*Ixz*Iyy*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) + 2*Ixy*Ixz*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 + 2*Ixy*Ixz*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) + 2*Iyy*Iyz*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 + 2*Iyy*Iyz*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) + 2*Iyy*Izy*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)^2*sin(phi)^3 + 2*Iyy*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)^2*sin(phi) + Ixx*Iyy^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx^2*Iyy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx*Iyz^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx*Izy^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx*Izz^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx^2*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Iyy*Izx^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) + Iyx^2*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx*Ixz*Iyx*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Ixy*Izx*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - 2*Ixx*Iyy*Iyz*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixy*Iyx*Iyz*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixz*Iyx*Iyy*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Iyx*Iyy*Izx*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - 2*Ixx*Izy*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixy*Izx*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixz*Izx*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Iyx*Izx*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Ixy*Iyx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Ixx*Ixz*Izx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Ixy*Iyx*Iyy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 - Ixz*Iyx*Iyz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Ixy*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + Iyx*Iyz*Izx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 - Ixz*Izx*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 - Iyx*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th)^2 + 2*Ixy^2*Iyx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - Ixz^2*Iyx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) + Ixy*Iyz^2*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) + Ixz*Iyy^2*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - Ixy^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + 2*Ixz^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + Ixy*Izz^2*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) + Ixz*Izy^2*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + 2*Iyx*Izy^2*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - Iyy^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - Iyx*Izz^2*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) + 2*Iyz^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - Ixx*Ixy*Iyz*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixz*Iyy*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixy*Izz*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixx*Ixz*Izy*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Ixy*Iyy*Iyz*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixz*Iyy*Iyz*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Iyx*Iyy*Izz*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Iyx*Iyz*Izy*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Ixy*Izy*Izz*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixz*Izy*Izz*dphi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Iyy*Izx*Izz*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - Iyz*Izx*Izy*dphi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixy*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) + Ixx*Iyy*Iyz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) - 3*Ixy*Iyx*Iyz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) + 2*Ixz*Iyx*Iyy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) + Iyx*Iyy*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) + Ixx*Izy*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) - 3*Ixy*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) + 2*Ixz*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th)*sin(th) + Ixx*Ixy*Iyz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) - 2*Ixx*Ixz*Iyy*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) + Ixy*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) - Ixx*Ixy*Izy*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) - Ixy*Iyy*Iyz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) - Iyx*Iyy*Izy*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) - Ixy*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) + Iyx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) - 2*Iyy*Izx*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) + Iyz*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^3*cos(th)*sin(th) + Ixx*Ixy*Iyx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx*Ixz*Izx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixy*Iyx*Iyy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixz*Iyx*Iyz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixy*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - Iyx*Iyz*Izx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixz*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) + Iyx*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi)*sin(th) - 2*Ixx*Ixy*Iyy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) + 3*Ixx*Ixy*Iyz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - 3*Ixy*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + Ixx*Ixz*Iyz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) + Ixx*Ixy*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + 3*Ixx*Ixz*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - 3*Ixy*Ixz*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - 2*Ixx*Ixz*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - Ixy*Iyy*Iyz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - Ixz*Iyy*Iyz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) + Iyx*Iyy*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + 3*Iyx*Iyz*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - 3*Iyy*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - Ixy*Izy*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - 2*Iyx*Iyz*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) - Ixz*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - 2*Iyy*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th) - 3*Iyx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + 3*Iyz*Izx*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2*sin(th) + Iyz*Izx*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi)*sin(th))/(cos(th)*(cos(phi)^2 + sin(phi)^2)*(Ixx*Iyy*Izz - Ixx*Iyz*Izy - Ixy*Iyx*Izz + Ixy*Iyz*Izx + Ixz*Iyx*Izy - Ixz*Iyy*Izx));
    dX_dt(11) = -(Ixx*Iyz*U4*cos(phi) - Ixz*Iyx*U4*cos(phi) - Ixx*Izz*U3*cos(phi) + Ixz*Izx*U3*cos(phi) + Iyx*Izz*U2*cos(phi) - Iyz*Izx*U2*cos(phi) + Ixx*Iyy*U4*sin(phi) - Ixy*Iyx*U4*sin(phi) - Ixx*Izy*U3*sin(phi) + Ixy*Izx*U3*sin(phi) + Iyx*Izy*U2*sin(phi) - Iyy*Izx*U2*sin(phi) + Ixz*Iyx^2*dphi_dt^2*cos(phi) + Ixz*Izx^2*dphi_dt^2*cos(phi) + Ixy*Iyx^2*dphi_dt^2*sin(phi) + Ixy*Izx^2*dphi_dt^2*sin(phi) - Ixy^2*Iyx*dth_dt^2*cos(phi)^2*sin(phi) + Ixz^2*Iyx*dth_dt^2*cos(phi)^2*sin(phi) + Ixy^2*Izx*dth_dt^2*cos(phi)*sin(phi)^2 - Ixz^2*Izx*dth_dt^2*cos(phi)*sin(phi)^2 - Iyx*Izy^2*dth_dt^2*cos(phi)^2*sin(phi) + Iyy^2*Izx*dth_dt^2*cos(phi)*sin(phi)^2 + Iyx*Izz^2*dth_dt^2*cos(phi)^2*sin(phi) - Iyz^2*Izx*dth_dt^2*cos(phi)*sin(phi)^2 + Ixz*Iyx^2*dpsi_dt^2*cos(phi)*sin(th)^2 + Ixz*Izx^2*dpsi_dt^2*cos(phi)*sin(th)^2 + Ixx*Ixy*Iyz*dth_dt^2*cos(phi)^3 - Ixy*Ixz*Iyx*dth_dt^2*cos(phi)^3 - Iyx*Izy*Izz*dth_dt^2*cos(phi)^3 + Iyz*Izx*Izy*dth_dt^2*cos(phi)^3 + Ixy*Iyx^2*dpsi_dt^2*sin(phi)*sin(th)^2 + Ixy*Izx^2*dpsi_dt^2*sin(phi)*sin(th)^2 + Ixx*Ixz*Izy*dth_dt^2*sin(phi)^3 - Ixy*Ixz*Izx*dth_dt^2*sin(phi)^3 + Iyx*Iyz*Izy*dth_dt^2*sin(phi)^3 - Iyy*Iyz*Izx*dth_dt^2*sin(phi)^3 + Ixx^2*Iyz*dphi_dt*dth_dt*cos(phi)^2 + Iyz*Izx^2*dphi_dt*dth_dt*cos(phi)^2 - Ixx^2*Izy*dphi_dt*dth_dt*sin(phi)^2 - Iyx^2*Izy*dphi_dt*dth_dt*sin(phi)^2 - Ixz^2*Izx*dpsi_dt^2*cos(phi)^3*cos(th)^2 - Iyz^2*Izx*dpsi_dt^2*cos(phi)^3*cos(th)^2 - Ixy^2*Iyx*dpsi_dt^2*cos(th)^2*sin(phi)^3 - Iyx*Izy^2*dpsi_dt^2*cos(th)^2*sin(phi)^3 - Ixx*Iyx*Iyz*dphi_dt^2*cos(phi) - Ixx*Izx*Izz*dphi_dt^2*cos(phi) - Ixx*Iyx*Iyy*dphi_dt^2*sin(phi) - Ixx*Izx*Izy*dphi_dt^2*sin(phi) + Ixx*Iyz^2*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Ixx*Izz^2*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Ixx^2*Izz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Iyx^2*Izz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Ixx*Ixy*Iyy*dth_dt^2*cos(phi)^2*sin(phi) - Ixx*Ixz*Iyy*dth_dt^2*cos(phi)*sin(phi)^2 + Ixy*Ixz*Iyx*dth_dt^2*cos(phi)*sin(phi)^2 - Ixx*Ixz*Iyz*dth_dt^2*cos(phi)^2*sin(phi) - Ixx*Ixy*Izy*dth_dt^2*cos(phi)*sin(phi)^2 - Ixx*Ixy*Izz*dth_dt^2*cos(phi)^2*sin(phi) + Ixy*Ixz*Izx*dth_dt^2*cos(phi)^2*sin(phi) + Ixx*Ixz*Izz*dth_dt^2*cos(phi)*sin(phi)^2 - Iyx*Iyy*Izy*dth_dt^2*cos(phi)*sin(phi)^2 - Iyx*Iyy*Izz*dth_dt^2*cos(phi)^2*sin(phi) + Iyy*Iyz*Izx*dth_dt^2*cos(phi)^2*sin(phi) + Iyx*Iyz*Izz*dth_dt^2*cos(phi)*sin(phi)^2 + Iyy*Izx*Izy*dth_dt^2*cos(phi)^2*sin(phi) + Iyx*Izy*Izz*dth_dt^2*cos(phi)*sin(phi)^2 - Iyy*Izx*Izz*dth_dt^2*cos(phi)*sin(phi)^2 - Iyz*Izx*Izz*dth_dt^2*cos(phi)^2*sin(phi) + Ixx*Iyy^2*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Ixx^2*Iyy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) + Ixx*Izy^2*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Iyy*Izx^2*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Ixx*Iyx*Iyz*dpsi_dt^2*cos(phi)*sin(th)^2 - Ixx*Izx*Izz*dpsi_dt^2*cos(phi)*sin(th)^2 - Ixx*Iyz^2*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixx*Izz^2*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixx^2*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Iyx^2*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixz^2*Iyx*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Iyx*Izz^2*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Ixx*Iyx*Iyy*dpsi_dt^2*sin(phi)*sin(th)^2 - Ixx*Izx*Izy*dpsi_dt^2*sin(phi)*sin(th)^2 - Ixx*Iyy^2*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixx^2*Iyy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx*Izy^2*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Iyy*Izx^2*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx^2*Iyz*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Ixy^2*Izx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Iyy^2*Izx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Iyz*Izx^2*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Ixx*Ixz*Iyx*dphi_dt*dth_dt*cos(phi)^2 - Ixx*Iyy*Iyz*dphi_dt*dth_dt*cos(phi)^2 + Ixz*Iyx*Iyy*dphi_dt*dth_dt*cos(phi)^2 - Ixx*Izy*Izz*dphi_dt*dth_dt*cos(phi)^2 + Ixz*Izx*Izy*dphi_dt*dth_dt*cos(phi)^2 - Iyx*Izx*Izz*dphi_dt*dth_dt*cos(phi)^2 + Ixx^2*Izy*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Iyx^2*Izy*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixx*Ixy*Izx*dphi_dt*dth_dt*sin(phi)^2 + Ixx*Iyy*Iyz*dphi_dt*dth_dt*sin(phi)^2 - Ixy*Iyx*Iyz*dphi_dt*dth_dt*sin(phi)^2 + Iyx*Iyy*Izx*dphi_dt*dth_dt*sin(phi)^2 + Ixx*Izy*Izz*dphi_dt*dth_dt*sin(phi)^2 - Ixy*Izx*Izz*dphi_dt*dth_dt*sin(phi)^2 - Ixz^2*Iyx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Ixy^2*Izx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Iyy^2*Izx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Iyx*Izz^2*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Ixx*Ixz*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^2 + Iyx*Iyz*Izz*dpsi_dt^2*cos(phi)^3*cos(th)^2 + Ixx*Ixy*Iyy*dpsi_dt^2*cos(th)^2*sin(phi)^3 + Iyy*Izx*Izy*dpsi_dt^2*cos(th)^2*sin(phi)^3 - Ixx*Iyy^2*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixx^2*Iyy*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixx*Iyz^2*dphi_dt*dth_dt*cos(phi)*sin(phi) - Ixx*Izy^2*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixx*Izz^2*dphi_dt*dth_dt*cos(phi)*sin(phi) - Ixx^2*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi) + Iyy*Izx^2*dphi_dt*dth_dt*cos(phi)*sin(phi) - Iyx^2*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi) - 2*Ixz*Iyx^2*dphi_dt*dpsi_dt*cos(phi)*sin(th) - 2*Ixz*Izx^2*dphi_dt*dpsi_dt*cos(phi)*sin(th) - 2*Ixy*Iyx^2*dphi_dt*dpsi_dt*sin(phi)*sin(th) - 2*Ixy*Izx^2*dphi_dt*dpsi_dt*sin(phi)*sin(th) + Ixx*Ixy*Iyx*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Ixy*Iyx*Iyy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Ixy*Izx*Izy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) + Iyx*Izx*Izy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - 2*Ixy^2*Iyx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixz^2*Iyx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - Ixy^2*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + 2*Ixz^2*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - 2*Iyx*Izy^2*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - Iyy^2*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Iyx*Izz^2*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + 2*Iyz^2*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixx*Ixz*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixz*Iyx*Iyz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixx*Iyy*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixx*Iyz*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixy*Iyx*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixy*Iyz*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixz*Iyx*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixz*Iyy*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Iyx*Iyz*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixz*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixx*Ixz*Iyz*dpsi_dt*dth_dt*cos(phi)^3*cos(th) + Ixx*Ixy*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Ixy*Ixz*Izx*dpsi_dt*dth_dt*cos(phi)^3*cos(th) + Iyx*Iyy*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Iyy*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)^3*cos(th) + Iyz*Izx*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Ixx*Ixy*Iyx*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixy*Iyx*Iyy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixx*Iyy*Izz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx*Iyz*Izy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixy*Iyx*Izz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixy*Iyz*Izx*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixz*Iyx*Izy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixz*Iyy*Izx*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixy*Izx*Izy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Iyx*Izx*Izy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixx*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Ixx*Ixz*Iyy*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixy*Ixz*Iyx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Ixx*Ixy*Izy*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixx*Iyy*Iyz*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Ixz*Iyx*Iyy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Iyx*Iyy*Izy*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Ixz*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Iyx*Izx*Izz*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Iyx*Izy*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Iyy*Izx*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Ixx*Ixy*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Ixx*Iyy*Iyz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixy*Iyx*Iyz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Iyx*Iyy*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Ixx*Izy*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixy*Izx*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixx*Ixy*Iyz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Ixx*Ixz*Iyy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - 2*Ixy*Ixz*Iyx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Ixx*Ixz*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Ixx*Ixy*Izy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Ixx*Ixy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Ixx*Ixz*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - 2*Ixy*Ixz*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Iyx*Iyy*Izy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Iyx*Iyy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Iyx*Iyz*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - 2*Iyy*Iyz*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - 2*Iyx*Izy*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Iyy*Izx*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Iyz*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Iyz*Izx*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Ixx^2*Iyz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx^2*Izy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Iyx^2*Izy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Iyz*Izx^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx^2*Iyz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixx^2*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Iyx^2*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Iyz*Izx^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixx*Iyy^2*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx^2*Iyy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Iyz^2*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixx*Izy^2*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Izz^2*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixx^2*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Iyy*Izx^2*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Iyx^2*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Ixy*Iyx*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixx*Ixz*Izx*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixy*Iyx*Iyy*dphi_dt*dth_dt*cos(phi)*sin(phi) - Ixz*Iyx*Iyz*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixy*Izx*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi) + Iyx*Iyz*Izx*dphi_dt*dth_dt*cos(phi)*sin(phi) - Ixz*Izx*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi) - Iyx*Izx*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi) + 2*Ixx*Iyx*Iyz*dphi_dt*dpsi_dt*cos(phi)*sin(th) + 2*Ixx*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)*sin(th) + 2*Ixx*Iyx*Iyy*dphi_dt*dpsi_dt*sin(phi)*sin(th) + 2*Ixx*Izx*Izy*dphi_dt*dpsi_dt*sin(phi)*sin(th) + Ixx*Ixz*Izx*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Ixz*Iyx*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Iyx*Iyz*Izx*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Ixz*Izx*Izz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Ixx*Ixz*Iyx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx*Ixy*Izx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + 2*Ixx*Iyy*Iyz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixy*Iyx*Iyz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixz*Iyx*Iyy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Iyx*Iyy*Izx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + 2*Ixx*Izy*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixy*Izx*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixz*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Iyx*Izx*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx*Ixz*Iyx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixx*Ixy*Izx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - 2*Ixx*Iyy*Iyz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixy*Iyx*Iyz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixz*Iyx*Iyy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Iyx*Iyy*Izx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - 2*Ixx*Izy*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixy*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixz*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Iyx*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixx*Ixy*Iyx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Ixz*Izx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixy*Iyx*Iyy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixz*Iyx*Iyz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixy*Izx*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Iyx*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixz*Izx*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Iyx*Izx*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + 2*Ixx*Ixy*Iyy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + 2*Ixx*Ixy*Iyz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Ixx*Ixz*Iyy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - 3*Ixy*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixx*Ixz*Iyz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixy*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixx*Ixy*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - 2*Ixx*Ixz*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + 3*Ixy*Ixz*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - 2*Ixx*Ixz*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Iyx*Iyy*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Iyx*Iyy*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - 2*Iyx*Iyz*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + 3*Iyy*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - 2*Iyx*Iyz*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + 2*Iyy*Izx*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - 3*Iyx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Iyy*Izx*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + 2*Iyz*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Iyz*Izx*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2)/((cos(phi)^2 + sin(phi)^2)*(Ixx*Iyy*Izz - Ixx*Iyz*Izy - Ixy*Iyx*Izz + Ixy*Iyz*Izx + Ixz*Iyx*Izy - Ixz*Iyy*Izx));
    dX_dt(12) = -(Ixy*Iyx*U4*cos(phi) - Ixx*Iyy*U4*cos(phi) + Ixx*Izy*U3*cos(phi) - Ixy*Izx*U3*cos(phi) - Iyx*Izy*U2*cos(phi) + Iyy*Izx*U2*cos(phi) + Ixx*Iyz*U4*sin(phi) - Ixz*Iyx*U4*sin(phi) - Ixx*Izz*U3*sin(phi) + Ixz*Izx*U3*sin(phi) + Iyx*Izz*U2*sin(phi) - Iyz*Izx*U2*sin(phi) + Ixy^2*Iyx*dth_dt^2*cos(phi)^3 + Iyx*Izy^2*dth_dt^2*cos(phi)^3 - Ixz^2*Izx*dth_dt^2*sin(phi)^3 - Iyz^2*Izx*dth_dt^2*sin(phi)^3 - Ixy*Iyx^2*dphi_dt^2*cos(phi) - Ixy*Izx^2*dphi_dt^2*cos(phi) + Ixz*Iyx^2*dphi_dt^2*sin(phi) + Ixz*Izx^2*dphi_dt^2*sin(phi) + Ixz^2*Iyx*dth_dt^2*cos(phi)*sin(phi)^2 - Ixy^2*Izx*dth_dt^2*cos(phi)^2*sin(phi) - Iyy^2*Izx*dth_dt^2*cos(phi)^2*sin(phi) + Iyx*Izz^2*dth_dt^2*cos(phi)*sin(phi)^2 - Ixy*Iyx^2*dpsi_dt^2*cos(phi)*sin(th)^2 - Ixy*Izx^2*dpsi_dt^2*cos(phi)*sin(th)^2 - Ixx*Ixy*Iyy*dth_dt^2*cos(phi)^3 - Iyy*Izx*Izy*dth_dt^2*cos(phi)^3 + Ixz*Iyx^2*dpsi_dt^2*sin(phi)*sin(th)^2 + Ixz*Izx^2*dpsi_dt^2*sin(phi)*sin(th)^2 + Ixx*Ixz*Izz*dth_dt^2*sin(phi)^3 + Iyx*Iyz*Izz*dth_dt^2*sin(phi)^3 + Ixx*Iyy^2*dphi_dt*dth_dt*cos(phi)^2 - Ixx^2*Iyy*dphi_dt*dth_dt*cos(phi)^2 + Ixx*Izy^2*dphi_dt*dth_dt*cos(phi)^2 - Iyy*Izx^2*dphi_dt*dth_dt*cos(phi)^2 + Ixx*Iyz^2*dphi_dt*dth_dt*sin(phi)^2 + Ixx*Izz^2*dphi_dt*dth_dt*sin(phi)^2 - Ixx^2*Izz*dphi_dt*dth_dt*sin(phi)^2 - Iyx^2*Izz*dphi_dt*dth_dt*sin(phi)^2 + Ixx*Iyx*Iyy*dphi_dt^2*cos(phi) + Ixx*Izx*Izy*dphi_dt^2*cos(phi) - Ixx*Iyx*Iyz*dphi_dt^2*sin(phi) - Ixx*Izx*Izz*dphi_dt^2*sin(phi) + Ixx^2*Izy*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Iyx^2*Izy*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Ixx*Ixy*Iyz*dth_dt^2*cos(phi)^2*sin(phi) + Ixx*Ixz*Iyy*dth_dt^2*cos(phi)^2*sin(phi) - 2*Ixy*Ixz*Iyx*dth_dt^2*cos(phi)^2*sin(phi) - Ixx*Ixz*Iyz*dth_dt^2*cos(phi)*sin(phi)^2 + Ixx*Ixy*Izy*dth_dt^2*cos(phi)^2*sin(phi) - Ixx*Ixy*Izz*dth_dt^2*cos(phi)*sin(phi)^2 - Ixx*Ixz*Izy*dth_dt^2*cos(phi)*sin(phi)^2 + 2*Ixy*Ixz*Izx*dth_dt^2*cos(phi)*sin(phi)^2 + Iyx*Iyy*Izy*dth_dt^2*cos(phi)^2*sin(phi) - Iyx*Iyy*Izz*dth_dt^2*cos(phi)*sin(phi)^2 - Iyx*Iyz*Izy*dth_dt^2*cos(phi)*sin(phi)^2 + 2*Iyy*Iyz*Izx*dth_dt^2*cos(phi)*sin(phi)^2 - 2*Iyx*Izy*Izz*dth_dt^2*cos(phi)^2*sin(phi) + Iyy*Izx*Izz*dth_dt^2*cos(phi)^2*sin(phi) + Iyz*Izx*Izy*dth_dt^2*cos(phi)^2*sin(phi) - Iyz*Izx*Izz*dth_dt^2*cos(phi)*sin(phi)^2 - Ixx^2*Iyz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Iyz*Izx^2*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) + Ixx*Iyx*Iyy*dpsi_dt^2*cos(phi)*sin(th)^2 + Ixx*Izx*Izy*dpsi_dt^2*cos(phi)*sin(th)^2 - Ixx^2*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Iyx^2*Izy*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixy^2*Izx*dpsi_dt*dth_dt*cos(phi)^3*cos(th) + Iyy^2*Izx*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Ixx*Iyx*Iyz*dpsi_dt^2*sin(phi)*sin(th)^2 - Ixx*Izx*Izz*dpsi_dt^2*sin(phi)*sin(th)^2 + Ixx^2*Iyz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Iyz*Izx^2*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx*Iyy^2*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Ixx^2*Iyy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Ixz^2*Iyx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Ixx*Izy^2*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Iyy*Izx^2*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Iyx*Izz^2*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixx*Ixy*Iyx*dphi_dt*dth_dt*cos(phi)^2 - Ixy*Iyx*Iyy*dphi_dt*dth_dt*cos(phi)^2 - Ixx*Iyy*Izz*dphi_dt*dth_dt*cos(phi)^2 + Ixx*Iyz*Izy*dphi_dt*dth_dt*cos(phi)^2 + Ixy*Iyx*Izz*dphi_dt*dth_dt*cos(phi)^2 - Ixy*Iyz*Izx*dphi_dt*dth_dt*cos(phi)^2 - Ixz*Iyx*Izy*dphi_dt*dth_dt*cos(phi)^2 + Ixz*Iyy*Izx*dphi_dt*dth_dt*cos(phi)^2 - Ixy*Izx*Izy*dphi_dt*dth_dt*cos(phi)^2 + Iyx*Izx*Izy*dphi_dt*dth_dt*cos(phi)^2 - Ixx*Iyz^2*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Ixx*Izz^2*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixx^2*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Iyx^2*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixx*Ixz*Izx*dphi_dt*dth_dt*sin(phi)^2 - Ixz*Iyx*Iyz*dphi_dt*dth_dt*sin(phi)^2 - Ixx*Iyy*Izz*dphi_dt*dth_dt*sin(phi)^2 + Ixx*Iyz*Izy*dphi_dt*dth_dt*sin(phi)^2 + Ixy*Iyx*Izz*dphi_dt*dth_dt*sin(phi)^2 - Ixy*Iyz*Izx*dphi_dt*dth_dt*sin(phi)^2 - Ixz*Iyx*Izy*dphi_dt*dth_dt*sin(phi)^2 + Ixz*Iyy*Izx*dphi_dt*dth_dt*sin(phi)^2 + Iyx*Iyz*Izx*dphi_dt*dth_dt*sin(phi)^2 - Ixz*Izx*Izz*dphi_dt*dth_dt*sin(phi)^2 + Ixy^2*Iyx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Ixz^2*Iyx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Ixy^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Ixz^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Iyx*Izy^2*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Iyy^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Iyx*Izz^2*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Iyz^2*Izx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Ixx*Ixz*Izy*dpsi_dt^2*cos(phi)^3*cos(th)^2 + Ixy*Ixz*Izx*dpsi_dt^2*cos(phi)^3*cos(th)^2 - Iyx*Iyz*Izy*dpsi_dt^2*cos(phi)^3*cos(th)^2 + Iyy*Iyz*Izx*dpsi_dt^2*cos(phi)^3*cos(th)^2 + Ixx*Ixy*Iyz*dpsi_dt^2*cos(th)^2*sin(phi)^3 - Ixy*Ixz*Iyx*dpsi_dt^2*cos(th)^2*sin(phi)^3 - Iyx*Izy*Izz*dpsi_dt^2*cos(th)^2*sin(phi)^3 + Iyz*Izx*Izy*dpsi_dt^2*cos(th)^2*sin(phi)^3 + Ixx^2*Iyz*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixx^2*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi) + Iyx^2*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi) + Iyz*Izx^2*dphi_dt*dth_dt*cos(phi)*sin(phi) + 2*Ixy*Iyx^2*dphi_dt*dpsi_dt*cos(phi)*sin(th) + 2*Ixy*Izx^2*dphi_dt*dpsi_dt*cos(phi)*sin(th) - 2*Ixz*Iyx^2*dphi_dt*dpsi_dt*sin(phi)*sin(th) - 2*Ixz*Izx^2*dphi_dt*dpsi_dt*sin(phi)*sin(th) + Ixx*Ixz*Iyx*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) + Ixx*Iyy*Iyz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Ixz*Iyx*Iyy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) + Ixx*Izy*Izz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) - Ixz*Izx*Izy*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) + Iyx*Izx*Izz*dpsi_dt^2*cos(th)*sin(phi)^2*sin(th) + 2*Ixy^2*Iyx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixz^2*Iyx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Ixy^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + 2*Ixz^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + 2*Iyx*Izy^2*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - Iyy^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - Iyx*Izz^2*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + 2*Iyz^2*Izx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixy*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixx*Iyy*Iyz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixy*Iyx*Iyz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Iyx*Iyy*Izx*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) + Ixx*Izy*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixy*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)^2*cos(th) - Ixx*Ixz*Iyy*dpsi_dt*dth_dt*cos(phi)^3*cos(th) + Ixy*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Ixx*Ixy*Izy*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Iyx*Iyy*Izy*dpsi_dt*dth_dt*cos(phi)^3*cos(th) + Iyx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Iyy*Izx*Izz*dpsi_dt*dth_dt*cos(phi)^3*cos(th) - Ixx*Ixz*Iyx*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx*Iyy*Iyz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixz*Iyx*Iyy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx*Izy*Izz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 + Ixz*Izx*Izy*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx*Ixy*Iyx*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Iyx*Izx*Izz*dphi_dt*dpsi_dt*cos(th)*sin(phi)^2 - Ixx*Ixz*Iyz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixy*Iyx*Iyy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Ixx*Ixy*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Ixy*Ixz*Izx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Ixx*Iyy*Izz*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Ixx*Iyz*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Ixy*Iyx*Izz*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Ixy*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Ixz*Iyx*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Ixz*Iyy*Izx*dpsi_dt*dth_dt*cos(phi)^2*sin(th) + Ixy*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Iyx*Iyy*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 + Iyy*Iyz*Izx*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Iyx*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*sin(th) - Iyz*Izx*Izz*dpsi_dt*dth_dt*cos(th)*sin(phi)^3 - Ixx*Ixz*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixz*Iyx*Iyz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Ixx*Iyy*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixx*Iyz*Izy*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixy*Iyx*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Ixy*Iyz*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Ixz*Iyx*Izy*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixz*Iyy*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Iyx*Iyz*Izx*dpsi_dt*dth_dt*sin(phi)^2*sin(th) + Ixz*Izx*Izz*dpsi_dt*dth_dt*sin(phi)^2*sin(th) - Ixx*Ixy*Iyy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Ixx*Ixz*Iyy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Ixy*Ixz*Iyx*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Ixx*Ixz*Iyz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Ixx*Ixy*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Ixx*Ixy*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Ixy*Ixz*Izx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Ixx*Ixz*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Iyx*Iyy*Izy*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Iyx*Iyy*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Iyy*Iyz*Izx*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Iyx*Iyz*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Iyy*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 + Iyx*Izy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) - Iyy*Izx*Izz*dpsi_dt^2*cos(phi)^2*cos(th)^2*sin(phi) + Iyz*Izx*Izz*dpsi_dt^2*cos(phi)*cos(th)^2*sin(phi)^2 - Ixx*Iyy^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx^2*Iyy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx*Iyz^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx*Izy^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx*Izz^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixx^2*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Iyy*Izx^2*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Iyx^2*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx*Iyy^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixx^2*Iyy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixx*Iyz^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixx*Izy^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixx*Izz^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixx^2*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Iyy*Izx^2*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Iyx^2*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixx^2*Iyz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx^2*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Iyx^2*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Iyz*Izx^2*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixx*Ixz*Iyx*dphi_dt*dth_dt*cos(phi)*sin(phi) - Ixx*Ixy*Izx*dphi_dt*dth_dt*cos(phi)*sin(phi) - 2*Ixx*Iyy*Iyz*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixy*Iyx*Iyz*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixz*Iyx*Iyy*dphi_dt*dth_dt*cos(phi)*sin(phi) - Iyx*Iyy*Izx*dphi_dt*dth_dt*cos(phi)*sin(phi) - 2*Ixx*Izy*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixy*Izx*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi) + Ixz*Izx*Izy*dphi_dt*dth_dt*cos(phi)*sin(phi) - Iyx*Izx*Izz*dphi_dt*dth_dt*cos(phi)*sin(phi) - 2*Ixx*Iyx*Iyy*dphi_dt*dpsi_dt*cos(phi)*sin(th) - 2*Ixx*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)*sin(th) + 2*Ixx*Iyx*Iyz*dphi_dt*dpsi_dt*sin(phi)*sin(th) + 2*Ixx*Izx*Izz*dphi_dt*dpsi_dt*sin(phi)*sin(th) - Ixx*Ixy*Izx*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Ixx*Iyy*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Ixy*Iyx*Iyz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Iyx*Iyy*Izx*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Ixx*Izy*Izz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) + Ixy*Izx*Izz*dpsi_dt^2*cos(phi)^2*cos(th)*sin(th) - Ixx*Ixy*Iyx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx*Ixz*Izx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixy*Iyx*Iyy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixz*Iyx*Iyz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixy*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Iyx*Iyz*Izx*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Ixz*Izx*Izz*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) - Iyx*Izx*Izy*dpsi_dt^2*cos(phi)*cos(th)*sin(phi)*sin(th) + Ixx*Ixy*Iyx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixx*Ixz*Izx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixy*Iyx*Iyy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixz*Iyx*Iyz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Ixy*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) - Iyx*Iyz*Izx*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixz*Izx*Izz*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Iyx*Izx*Izy*dphi_dt*dpsi_dt*cos(phi)*cos(th)*sin(phi) + Ixx*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Ixx*Ixy*Izx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + 2*Ixx*Iyy*Iyz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixy*Iyx*Iyz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixz*Iyx*Iyy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Iyx*Iyy*Izx*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + 2*Ixx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixy*Izx*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - Ixz*Izx*Izy*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) + Iyx*Izx*Izz*dpsi_dt*dth_dt*cos(phi)*sin(phi)*sin(th) - 2*Ixx*Ixy*Iyy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + 2*Ixx*Ixy*Iyz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixz*Iyy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - 3*Ixy*Ixz*Iyx*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixz*Iyz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + Ixx*Ixy*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Ixx*Ixy*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + 2*Ixx*Ixz*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - 3*Ixy*Ixz*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - 2*Ixx*Ixz*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Iyx*Iyy*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Iyx*Iyy*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) + 2*Iyx*Iyz*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - 3*Iyy*Iyz*Izx*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - 2*Iyx*Iyz*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 - 2*Iyy*Izx*Izy*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi) - 3*Iyx*Izy*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Iyy*Izx*Izz*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + 2*Iyz*Izx*Izy*dpsi_dt*dth_dt*cos(phi)*cos(th)*sin(phi)^2 + Iyz*Izx*Izz*dpsi_dt*dth_dt*cos(phi)^2*cos(th)*sin(phi))/(cos(th)*(cos(phi)^2 + sin(phi)^2)*(Ixx*Iyy*Izz - Ixx*Iyz*Izy - Ixy*Iyx*Izz + Ixy*Iyz*Izx + Ixz*Iyx*Izy - Ixz*Iyy*Izx));
    dX_dt = dX_dt'; % function should return column matrix
end